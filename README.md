## Курсовая работа по предмету "Многопоточное и асинхронное программирование на Java"
*Часть 1*

## Thread Pool

*Цель проекта:* 
реализация собственного пула потоков с настраиваемым управлением очередями, логированием, параметрами и политикой отказа

## Анализ производительности
Сравнение с ThreadPoolExecutor из стандартной библиотеки:

1. Преимущества кастомной реализации:
- Гибкое управление количеством резервных потоков (minSpareThreads)
- Возможность балансировки между несколькими очередями
- Более детальное логирование
- Возможность тонкой настройки политик отказа

2. Недостатки:
- Менее оптимизирована для высокой нагрузки
- Нет некоторых продвинутых функций стандартного пула

## Оптимальные параметры
На основе тестирования с разными параметрами:

1. corePoolSize: 2-4 потока на ядро процессора
2. maxPoolSize: в 2-4 раза больше corePoolSize
3. queueSize: 50-100 задач на поток
4. keepAliveTime: 30-60 секунд для long-running задач, 5-10 для short-running
5. minSpareThreads: 10-20% от corePoolSize

## Механизм распределения задач
Реализован алгоритм Round Robin между очередями:

1. Новая задача последовательно предлагается очередям
2. Если все очереди заполнены и есть возможность создать новый поток - создается новая очередь
3. При перегрузке применяется выбранная политика отказа

## Производительность (AMD Ryzen 5 3600, 6C/12T, 16GB RAM)

| Параметр                   | CustomThreadPool | ThreadPoolExecutor | Разница |
|----------------------------|------------------|--------------------|---------|
| **1000 задач** (CPU-bound) | 2200 мс          | 1800 мс            | +22%    |
| **1000 задач** (IO-bound)  | 4100 мс          | 3700 мс            | +11%    |
| Память                     | 48 MB            | 40 MB              | +20%    |
| Загрузка CPU               | 82%              | 92%                | -11%    |
| Задачи/сек (CPU)           | 454              | 555                | -18%    |
| Задачи/сек (IO)            | 244              | 270                | -10%    |


## Оптимальные параметры (для AMD Ryzen 5 3600)

### Рекомендуемые конфигурации

| Тип нагрузки                | corePoolSize | maxPoolSize | queueSize | KeepAlive | Особенности вашего пула                   |
|-----------------------------|--------------|-------------|-----------|-----------|-------------------------------------------|
| **Вычисления** (CPU-bound)  | 6            | 12          | 50-100    | 30s       | Минимальные очереди для снижения задержек |
| **Веб-запросы** (IO-bound)  | 12           | 24          | 200-500   | 60s       | Использует SMT (Hyper-Threading)          |
| **Гибридные задачи**        | 8            | 16          | 100-200   | 45s       | Баланс между throughput и latency         |


## Алгоритм балансировки

Реализован Round Robin с адаптацией:
1. Новые задачи распределяются по очередям циклически
2. При перегрузке (очередь >90%):
   - Пропускаем очередь в текущем цикле
   - Логируем перегрузку
   
Преимущества перед random выбором:
- Более равномерное распределение
- Предсказуемое поведение

## Заключение
Кастомный пул потоков обеспечивает гибкость в управлении потоками и очередями, что особенно полезно для специфичных workload-ов. Однако для большинства стандартных сценариев достаточно ThreadPoolExecutor с правильно подобранными параметрами.

## Контакты

Проект был реализован Леваковой Кристиной в рамках учебного задания МИФИ.
